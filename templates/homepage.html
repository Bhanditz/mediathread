{% extends "base.html" %}
{% load tagging_tags smartif user_projects helpful_tags coursetags comments collaborations revision %}

{% block title %}
    Home
{% endblock %}

{% block css %}
    {{ block.super }}
    
    <!--All the annotation css -->
    {% include "djangosherd/annotator_resources_css.html" %}
{% endblock %}

{% block js %}
    <script type="text/javascript" src="/site_media/js/ajaxDelete.js?version={%revision%}"></script>
      
    <!--All the annotation javascript -->
    {% include "djangosherd/annotator_resources.html" %}
    
    <script type="text/javascript" src="/site_media/js/mustache/mustache.js?version={%revision%}"></script>
    <script type="text/javascript" src="/site_media/js/mediathread_mustache.js?version={%revision%}"></script>
    <script type="text/javascript" src="/site_media/js/project/projectlist.js?version={%revision%}"></script>

    <script type="text/javascript">
        jQuery(document).ready(function() {
            jQuery("div#classwork_table").ajaxStart(function(){
                jQuery(this).addClass("ajaxLoading");
            });
            
            jQuery("div#classwork_table").ajaxStop(function(){
                jQuery(this).removeClass("ajaxLoading");
            });
            
            var projectList = new ProjectList({
                'parent': jQuery("div#classwork_table")[0],
                'space_owner': '{% ifnotequal role_in_course "non-member" %}{{classwork_owner.username}}{% endifnotequal %}',
                'template': 'homepage',
                'template_label': 'classwork_table',
                'view': "{{request.GET.view}}",
            });
        });
    </script>
{% endblock %}

{% block course_metadata %}
    <div id="course_metadata">Put course metadata here</div>
{% endblock %}

{% block content %}
    {{ block.super }}
        <div id="sitewide_menu">
            <ul>
                <li><a href="/asset/">View Full Collection</a> </li>
                <li>
                    <form class="project-createnew" action="/project/create/" method="post">
                        <input type="hidden" name="title">
                        {% if is_faculty %}
                            <input type="submit" value="Create Composition or Assignment">
                         {% else %}
                            <input type="submit" value="Create Composition">
                         {% endif %}
                    </form>
                </li>
            </ul>
        </div>   
    <table id="home-columns">
    <tbody>
        <tr>
            {% if faculty_feed.show or is_faculty %}
            <td class="" id="instructor">
                {% with "help_homepage_instructor_column" as help_id %}
                {% with help_homepage_instructor_column as default_help_state %}
                <div class="column-container">    
                   <h2>Course Information</h2>
                      <div class="column-contents scroll">
                        <div id="instructor-column">
                            {%if faculty_feed.projects %}
                                <h4 class="inst-header project">Information</h4>
                                <ul class="instructor-list">
                                    {%for project in faculty_feed.projects %}
                                        <li><a href="{{project.get_absolute_url}}">{{project.title}}</a></li>
                                    {%endfor%}
                                </ul>
                            {%endif%}
                            
                        
                            {% if discussions %}
                                <h4 class="inst-header discussion">Discussions</h4>
                                <ul class="instructor-list">
                                    {%for disc in discussions%}
                                        <li id="discussion-{{disc.id}}">
                                            <div class="actions">
                                                {% if is_faculty %}
                                                    <a onclick="return ajaxDelete(this, 'discussion-{{disc.id}}')"
                                                        href="{% url discussion-delete disc.id %}">
                                                    <img src="/site_media/img/Trashcan.gif"  class="delete_icon" alt="Remove this Discussion"  /></a>
                                                {% endif %}
                                            </div>
                                            <a href="/discussion/show/{{disc.id}}">{%firstof disc.title disc.content_object.title "Untitled" %}</a>
                                            {% get_comment_count for disc.content_object as comment_count%}
                                            ({{comment_count}})
                                        </li>
                                    {%endfor%}
                                </ul>
                            {% endif %}
                         </div>
                    </div>
                </div>
                {% endwith %}{% endwith %}
            </td>
            {% endif %}
        
            {% with "help_homepage_classwork_column" as help_id %}
            {% with help_homepage_classwork_column as default_help_state %}
            {% with "resizeHomepage" as callback %}
            <td id="classwork">
                <div class="column-container parent-column-container">
                    <h2>Dashboard</h2>
                    <div id="classwork_table"></div>
                </div>
            </td>
            <td id="explore">
            	<div class="column-container">
            	<h2>Add to My Collection</h2>
            		<div id="bookmarklet">
            		<strong>Install Bookmarklet in Firefox</strong>
            		    <ul>
            		        <li>In the View menu, show the "Bookmarks" toolbar.</li>
					        <li>Drag this link onto your browser bookmarks toolbar:<br />
					        <a class="bookmarklet" href="{% include "assetmgr/bookmarklet.js" %}">Analyze w/Mediathread</a></li>
					        <li>Clicking the Bookmarklet imports media from any web page containing Mediathread-friendly items.</li>
            	        </ul>
            		</div>
                    <div id="recommend">
                    <strong>Instructor Recommendations</strong>
                        <div class="recommend_source">
                            <div class="source_title"><a href="/">The Metropolitan Museum of Art</a></div>
                            <div class="source_thumb"><img src="http://www.metmuseum.org/content/img/presentation/icons/header-logo-icon.gif" /></div>

                        </div>
                        <div class="recommend_source">
                            <div class="source_title"><a href="/">Victoria and Albert Museum Archives</a></div>
                            <div class="source_thumb"><img src="http://books.google.com/intl/en/images/logos/books_logo_lg.gif" /></div>
                        </div>
                        <div class="recommend_source">
                            <div class="source_title"><a href="/">WGBH OpenVault: The Vietnam Collection </a></div>
                            <div class="source_thumb"><img src="http://ccnmtl.columbia.edu/projects/mediathread/skins/vietnam//img/bvault_bug.jpg" /></div>
                        </div>
                    </div>
                </div>
            </td>            
            {% endwith %}{% endwith %}{% endwith %}
        </tr>
    </tbody>
</table>

{% endblock %}
